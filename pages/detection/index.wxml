<view class="container">
  <view class="content">
    
    
    <!-- Tabs：有检测号 | 自费检测 -->
    <view class="tabs">
      <view class="tab-item {{activeMode==='code' ? 'active' : ''}}" data-mode="code" bindtap="switchMode">
        <text>有检测号</text>
      </view>
      <view class="tab-item {{activeMode==='paid' ? 'active' : ''}}" data-mode="paid" bindtap="switchMode">
        <text>自费检测</text>
      </view>
    </view>

      <!-- 🔬 检测号验证 -->
      <view class="detection-card" wx:if="{{activeMode==='code'}}">
        <view class="card-header">
          <text class="card-icon">🔬</text>
          <text class="card-title">检测号验证</text>
        </view>
        <view class="card-content">
          <view class="form-item">
            <view class="form-label">检测号:</view>
            <view class="form-input-wrapper">
              <input 
                class="form-input" 
                placeholder="请输入检测号" 
                value="{{detectionForm.detectionNumber}}"
                bindinput="onDetectionNumberInput"
              />
            </view>
          </view>
          <view class="form-item">
            <view class="form-label">手机号:</view>
            <view class="form-input-wrapper">
              <input 
                class="form-input" 
                placeholder="请输入手机号" 
                type="number"
                maxlength="11"
                value="{{detectionForm.phoneNumber}}"
                bindinput="onPhoneNumberInput"
              />
            </view>
          </view>
          <button class="u-btn u-btn-primary u-btn--md u-btn--pill u-btn-block" bindtap="verifyAndStartDetection">验证并开始检测</button>
        </view>
      </view>
      
      <!-- 💰 没有检测号？（自费检测） -->
      <view class="detection-card detection-card--spaced" wx:if="{{activeMode==='paid'}}">
        <view class="card-header">
          <text class="card-icon">💰</text>
          <text class="card-title">没有检测号？</text>
        </view>
        <view class="card-content">
          <text class="card-subtitle">选择自费检测服务</text>
          
          <view class="package-list">
            <view 
              class="package-item {{item.selected ? 'selected' : ''}}"
              wx:for="{{paidPackages}}" 
              wx:key="id"
              bindtap="selectPaidPackage"
              data-id="{{item.id}}"
            >
              <view class="package-header">
                <view class="package-name">{{item.name}}</view>
                <view class="package-price">¥{{item.price}}</view>
              </view>
              <view class="package-desc">{{item.desc}}</view>
            </view>
          </view>
          
          <button class="u-btn u-btn-primary u-btn--md u-btn--pill u-btn-block" bindtap="payForDetection">扫码支付</button>
        </view>
      </view>
    
    <!-- 结果查询入口卡片（置底） -->
    <view class="detection-card detection-card--spaced detection-card--results">
      <view class="card-header">
        <text class="card-icon">📄</text>
        <text class="card-title">结果查询</text>
      </view>
      <view class="card-content">
        <view wx:if="{{!loggedIn}}" class="login-tip">
          <text class="tip-text">请先登录后查询检测结果</text>
          <button class="btn-login u-btn u-btn-primary u-btn--sm" bindtap="handleLogin">微信一键登录</button>
        </view>
        <view wx:else class="login-tip">
          <text class="tip-text">已登录，可查看您的检测记录</text>
          <button class="btn-login u-btn u-btn-primary u-btn--sm" bindtap="goToResults">查看我的检测记录</button>
        </view>
      </view>
    </view>
  </view>
</view>
