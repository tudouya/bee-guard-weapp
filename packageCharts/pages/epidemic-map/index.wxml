<view class="epidemic-map">
  <view class="selector-bar">
    <picker mode="selector"
            range="{{provinces}}"
            range-key="name"
            bindchange="onProvinceChange"
            disabled="{{regionLoading}}">
      <view class="selector-bar__item">
        <text class="selector-bar__label">省：</text>
        <text>{{selectedProvince ? selectedProvince.name : '请选择'}}</text>
      </view>
    </picker>
    <picker mode="selector"
            range="{{counties}}"
            range-key="name"
            bindchange="onCountyChange"
            disabled="{{!counties.length}}">
      <view class="selector-bar__item {{!counties.length ? 'selector-bar__item--disabled' : ''}}">
        <text class="selector-bar__label">县：</text>
        <text>{{selectedCounty ? selectedCounty.name : (counties.length ? '请选择' : '暂无可选')}}</text>
      </view>
    </picker>
  </view>

  <view class="legend-bar" wx:if="{{legendItems.length}}">
    <block wx:for="{{legendItems}}" wx:key="key">
      <view class="legend-bar__item">
        <view class="legend-bar__dot" style="background: {{item.color}};"></view>
        <text class="legend-bar__text">{{item.name}}</text>
      </view>
    </block>
  </view>

  <view class="charts-wrapper" wx:if="{{chartGroups.length}}">
    <block wx:for="{{chartGroups}}" wx:for-item="group" wx:key="key">
      <view class="charts-group">
        <view class="charts-group__title">{{group.title}}</view>
        <scroll-view class="charts-row-scroll" scroll-x="true" enable-flex="true">
          <view class="charts-row">
            <block wx:for="{{group.months}}" wx:for-item="month" wx:key="chartId">
              <view class="chart-card">
                <view class="chart-card__month">{{month.monthLabel}}</view>
                <view class="chart-card__body" wx:if="{{month.hasData}}">
                  <ec-canvas id="{{month.chartId}}" canvas-id="{{month.chartId}}" class="chart-card__canvas" ec="{{month.ec}}"></ec-canvas>
                </view>
                <view class="chart-card__empty" wx:else>暂无数据</view>
              </view>
            </block>
          </view>
        </scroll-view>
      </view>
    </block>
  </view>

  <view class="charts-empty" wx:else>
    <text>暂无数据</text>
  </view>
</view>
